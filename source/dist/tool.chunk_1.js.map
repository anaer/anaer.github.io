{"version":3,"sources":["webpack:///tool.chunk_1.js","webpack:///./source/src/page/tool/link.js","webpack:///./source/src/model/link.js","webpack:///./source/src/card/common/daohang.js","webpack:///./source/src/card/common/linktab.js","webpack:///./source/src/card/tool/daohang.js","webpack:///./source/src/card/tool/link.js","webpack:///./source/src/helper/search.js"],"names":["webpackJsonp","module","exports","__webpack_require__","o_navigator","c_link","c_daohang","page","viewNav","$","setView","title","viewList","truncate","str","limit","chinese","RegExp","length","test","slice","m_util","m_search","links","linkTab","count","getLinks","Promise","resolve","BCD","ajaxCache","data","load","forEach","o","start","groupid","rows","arr","split","firstLetter","pinyinUtil","getFirstLetter","join","favicon","url","domain","item","name","href","searchKey","concat","push","tab","catch","e","console","info","searchDirect","word","reg","getGlobalRegex","regGlobal","filter","map","weight","replace","$0","searchHref","sort","a","b","getLinksSync","getLinkTabSync","o_linktab","container","styles","_loop","style","subContainer","full","key","d","reset","append","addEvent","ele","on","find","toggleClass","option","extend","template","m_link","then","viewInput","viewDrop","btnNotify","end","selectLi","selectList","index","oldWord","hide","val","setTimeout","focus","doSearch","encodeURIComponent","getWord","window","open","trim","ajax","type","dataType","crossDomain","success","tip","keyCode","trigger","css","eq","show","list","view","_toConsumableArray","Array","isArray","i","arr2","from","createNGram","n","substr","gramDict","4","3","2","getWordList","arguments","undefined","wordList","processStrict","processChiese","apply","processEnglish","toLowerCase","removeStopWord","$1","getTFs","threeDict","fourDict","tfDict","tfList","token","frequency","_loop2","flag","wordSet","Set"],"mappings":"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","file":"tool.chunk_1.js","sourcesContent":["webpackJsonp([1],[\n/* 0 */,\n/* 1 */,\n/* 2 */,\n/* 3 */,\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t/**\r\n\t * @file 导航页面定义\r\n\t * @author ljquan@qq.com\r\n\t */\n\t\n\tvar o_navigator = __webpack_require__(2);\n\tvar c_link = __webpack_require__(20);\n\tvar c_daohang = __webpack_require__(19);\n\t\n\tmodule.exports = function (page) {\n\t    var viewNav = $('<div></div>').setView(o_navigator());\n\t    page.setView({\n\t        title: '导航',\n\t        viewList: [viewNav, c_link, c_daohang]\n\t    });\n\t};\n\n/***/ }),\n/* 5 */,\n/* 6 */,\n/* 7 */,\n/* 8 */,\n/* 9 */,\n/* 10 */,\n/* 11 */,\n/* 12 */,\n/* 13 */,\n/* 14 */,\n/* 15 */,\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar m_util = __webpack_require__(3);\n\tvar m_search = __webpack_require__(21);\n\t\n\tvar links = [];\n\tvar linkTab = {};\n\tvar count = [];\n\t\n\tvar getLinks = new Promise(function (resolve) {\n\t  BCD.ajaxCache('./json/link.json', function (data) {\n\t    if (data.length) {\n\t      m_util.load(['source/lib/pinyinjs/dict/pinyin_dict_firstletter.js', 'source/lib/pinyinjs/pinyinUtil.js'], function () {\n\t        links = [];\n\t        linkTab = [];\n\t        count = [];\n\t        data.forEach(function (o) {\n\t          var start = links.length;\n\t          // 如果count[o.groupid]不存在，则初始化为0\n\t          if (!count[o.groupid]) {\n\t            count[o.groupid] = 0;\n\t          }\n\t          (o.rows || []).forEach(function (str) {\n\t            // 对同一groupid进行计数\n\t            count[o.groupid] = count[o.groupid] + 1;\n\t            // console.info(\"count[o.groupid]=\", count[o.groupid]);\n\t            var arr = str.split(' | ');\n\t            var firstLetter = pinyinUtil.getFirstLetter(arr[0], true).join(' ');\n\t            if (arr.length) {\n\t              var favicon = '';\n\t              var url = arr[1];\n\t              if (url) {\n\t                var domain = url.split('/');\n\t                if (domain[2]) {\n\t                  // 使用本地的favicon\n\t                  favicon = 'https://fastly.jsdelivr.net/gh/anaer/anaer.github.io@master/favicon/' + domain[2] + '.ico';\n\t                }\n\t              }\n\t              var item = {\n\t                // 缩写\n\t                name: truncate(arr[0], 20),\n\t                title: arr[0],\n\t                href: arr[1],\n\t                favicon: favicon,\n\t                firstLetter: firstLetter,\n\t                searchKey: arr.concat(o.title, firstLetter).join(' ')\n\t              };\n\t              links.push(item);\n\t            }\n\t          });\n\t          if (o.groupid) {\n\t            var tab = {\n\t              title: o.title,\n\t              rows: links.slice(start),\n\t              // 如果未设置limit, 则默认为6, 同一组最多显示6条. 防止太长\n\t              limit: o.limit || 6\n\t            };\n\t            if (linkTab[o.groupid]) {\n\t              linkTab[o.groupid].push(tab);\n\t            } else {\n\t              linkTab[o.groupid] = [tab];\n\t            }\n\t          }\n\t        });\n\t        resolve(data);\n\t      });\n\t    } else {\n\t      resolve(data);\n\t    }\n\t    return data.length ? 1 : 0;\n\t  }, 0, 3E3, 1);\n\t}).catch(function (e) {\n\t  return console.info(e);\n\t});\n\t\n\t/**\r\n\t * 截取字符串.\r\n\t *\r\n\t * @param {*} str 字符串\r\n\t * @param {*} limit 限制长度, 如果是中文, 再减4, 主要是中文宽度较宽\r\n\t * @returns\r\n\t */\n\tfunction truncate(str, limit) {\n\t  var chinese = RegExp('[\\u4E00-\\u9FA5]{0,}');\n\t  if (str.length > limit) {\n\t    if (chinese.test(str) && limit - 4 > 0) {\n\t      limit = limit - 4;\n\t    }\n\t    return str.slice(0, limit) + '...';\n\t  } else {\n\t    return str;\n\t  }\n\t}\n\t\n\t//搜索直达\n\tvar searchDirect = function searchDirect(word) {\n\t  var reg = m_search.getGlobalRegex(word, 'i');\n\t  var regGlobal = m_search.getGlobalRegex(word, 'ig');\n\t  //console.log(reg);\n\t  return links.filter(function (o) {\n\t    return reg.test(o.searchKey);\n\t  }).map(function (o) {\n\t    var weight = 0;\n\t    var item = {\n\t      href: o.href,\n\t      name: o.name.replace(regGlobal, function ($0) {\n\t        weight += 3 * $0.length;\n\t        return '<span class=\"am-text-danger\">' + $0 + '</span>';\n\t      })\n\t    };\n\t    if (word.length > 1) {\n\t      item.searchHref = o.href.replace(regGlobal, function ($0) {\n\t        weight += $0.length;\n\t        return '<span class=\"am-text-danger\">' + $0 + '</span>';\n\t      });\n\t    } else {\n\t      item.searchHref = o.href;\n\t    }\n\t\n\t    o.firstLetter.replace(regGlobal, function ($0) {\n\t      weight += 2 * $0.length;\n\t      return $0;\n\t    });\n\t    item.weight = weight;\n\t    return item;\n\t  }).sort(function (a, b) {\n\t    return b.weight - a.weight;\n\t  }).slice(0, 10);\n\t};\n\tmodule.exports = {\n\t  getLinks: getLinks,\n\t  searchDirect: searchDirect,\n\t  getLinksSync: function getLinksSync() {\n\t    return links;\n\t  },\n\t  getLinkTabSync: function getLinkTabSync() {\n\t    return linkTab;\n\t  }\n\t};\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar o_linktab = __webpack_require__(18);\n\t\n\tmodule.exports = function (container, linkTab) {\n\t  var count = 0;\n\t  var styles = ['', 'warning', 'danger', 'success'];\n\t\n\t  var _loop = function _loop() {\n\t    var style = styles[count % 4];\n\t    count++;\n\t    var subContainer = $('<div></div>').setView(o_linktab({\n\t      full: 'append'\n\t    }));\n\t    linkTab[key].forEach(function (d) {\n\t      d.style = style;\n\t      subContainer.reset(d);\n\t    });\n\t    container.append(subContainer);\n\t  };\n\t\n\t  for (var key in linkTab) {\n\t    _loop();\n\t  }\n\t};\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tBCD.addEvent('expand', function (ele) {\n\t    ele.on('click', function (e) {\n\t        ele.find('ul.am-list > li.expand').toggleClass('am-hide');\n\t    });\n\t});\n\t\n\t// 默认隐藏二维码button\n\tmodule.exports = function (option) {\n\t    return $.extend({\n\t        name: 'common/linktab',\n\t        template: '<div class=\"am-u-sm-12 am-u-md-6 am-u-lg-4\">' + '    <section class=\"am-panel am-panel-<%=obj.style||\"secondary\"%>\"  data-on=\"?m=expand\">' + '        <header class=\"am-panel-hd\" >' + '            <h3 class=\"am-panel-title\" ><%=obj.title%></h3>' + '        </header>' + '        <div class=\"am-panel-bd\">' + '            <ul class=\"am-list\">' + '                <%var list = obj.rows; for(var i=0, len=list.length; i<len; i++){%>' + '                <%if(i < obj.limit){ %>' + '                <li style=\"padding:8px\">' + '                  <span >' + '                    <a data-on=\"?m=<%=config.isEnv ? \"goEnv\" : \"go\"%>&target=_blank\" data-url=\"<%=list[i].href%>\" title=\"<%=list[i].title%>\">' + '                      <img style=\"height:16px; width:16px\" src=\"<%=list[i].favicon%>\">  </img><%=list[i].name%>' + '                    </a>' + '                  </span>' + '                <button style=\"display:none\" type=\"button\" class=\"am-btn am-btn-default am-btn-xs\" style=\"float:right\" data-on=\"?m=goQR<%=config.isEnv ? \"&env=1\" : \"\"%>\" data-url=\"<%=list[i].href%>\">QR</button>' + '                </li>' + '                <%} else {%>' + '                <li style=\"padding:8px\" class=\"expand am-hide\" >' + '                  <span >' + '                    <a data-on=\"?m=<%=config.isEnv ? \"goEnv\" : \"go\"%>&target=_blank\" data-url=\"<%=list[i].href%>\" title=\"<%=list[i].title%>\">' + '                      <img style=\"height:16px; width:16px\" src=\"<%=list[i].favicon%>\">  </img><%=list[i].name%>' + '                    </a>' + '                  </span>' + '                <button style=\"display:none\" type=\"button\" class=\"am-btn am-btn-default am-btn-xs\" style=\"float:right\" data-on=\"?m=goQR<%=config.isEnv ? \"&env=1\" : \"\"%>\" data-url=\"<%=list[i].href%>\">QR</button>' + '                </li>' + '                <%}%>' + '                <%}%>' + '            </ul>' + '        </div>' + '    </section>' + '</div>'\n\t    }, option);\n\t};\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar m_link = __webpack_require__(16);\n\t\n\tvar c_daohang = __webpack_require__(17);\n\t\n\tvar container = $('<div class=\"am-container\"></div>');\n\t\n\tm_link.getLinks.then(function (data) {\n\t    c_daohang(container, m_link.getLinkTabSync());\n\t});\n\t\n\tmodule.exports = container;\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\t//地址\n\tvar m_link = __webpack_require__(16);\n\t\n\tBCD.addEvent('fast_input', function (ele) {\n\t  var viewInput = ele.find('#content');\n\t  var viewDrop = ele.find('[data-selector=\"dropdown\"]');\n\t  var btnNotify = ele.find('#notify');\n\t  viewDrop.setView({\n\t    name: 'link/drop',\n\t    template: '<ul><%(obj ||[]).forEach(function(o, i){%>' + '<li data-on=\"?m=open\" data-url=\"<%=o.href%>\">' + ' <div class=\"left\"><span class=\"am-badge am-round\"><%=i%></span></div>' + ' <div class=\"right\"><a><%=o.name%></a><div class=\"addr\"><%=o.searchHref%></div></div>' + '</li>' + '<%})%></ul>' + '<div class=\"tips\">提示：Tab键打开第一个链接、数字键打开对应链接、上下键选择、回车键打开、Esc键还原</div>',\n\t    end: function end(data) {\n\t      if (!data.length) {\n\t        return 'hide';\n\t      }\n\t    }\n\t  });\n\t  var selectLi = null;\n\t  var selectList = null;\n\t  var index = -1;\n\t  var oldWord = '';\n\t  var reset = function reset() {\n\t    viewDrop.hide();\n\t    viewInput.val('');\n\t    selectLi = null;\n\t    selectList = null;\n\t    index = -1;\n\t    oldWord = '';\n\t    setTimeout(function () {\n\t      return viewInput[0].focus();\n\t    }, 300);\n\t  };\n\t  var doSearch = function doSearch() {\n\t    var href = 'https://www.baidu.com/s?wd=' + encodeURIComponent(getWord());\n\t    // let href = 'https://www.ecosia.org/search?q='+encodeURIComponent(getWord());\n\t    // let href = 'https://duckduckgo.com/?q='+encodeURIComponent(getWord());\n\t    reset();\n\t    window.open(href);\n\t  };\n\t  var getWord = function getWord() {\n\t    return viewInput.val().trim();\n\t  };\n\t  viewInput.on('blur', function () {\n\t    setTimeout(function () {\n\t      viewDrop.hide();\n\t    }, 300);\n\t  });\n\t\n\t  btnNotify.on('click', function () {\n\t    setTimeout(function () {\n\t      var word = getWord();\n\t      if (word) {\n\t        $.ajax({\n\t          url: \"https://api2.pushdeer.com/message/push?pushkey=PDU3423TORUEz2NZHKZVIpSlb2ErGJcERTunXneI&text=\" + encodeURIComponent(word),\n\t          type: 'get',\n\t          dataType: 'jsonp', // 请求方式为jsonp\n\t          crossDomain: true,\n\t          data: {},\n\t          success: function success(data) {}\n\t        });\n\t        // 放success里 好像没提示, 不搞前端, 不确定原因, 先放外面提示已通知\n\t        // alert('已通知');\n\t        $(btnNotify).tip('已通知');\n\t      }\n\t    }, 300);\n\t  });\n\t  ele.on('keydown', function (e) {\n\t    //上下选择\n\t    //console.log(e.keyCode);\n\t    if (e.keyCode == 27) {\n\t      return reset();\n\t    }\n\t    if (e.keyCode == 13) {\n\t      if (selectLi) {\n\t        selectLi.trigger('click');\n\t        reset();\n\t      } else {\n\t        doSearch();\n\t      }\n\t      return;\n\t    }\n\t    if (!(selectList && selectList.length)) {\n\t      return;\n\t    }\n\t    var word = getWord();\n\t    if (e.keyCode > 95 && e.keyCode < 106 && !/^\\d+$/.test(word)) {\n\t      //0-9 是96-105 小键盘的数字键\n\t      if (selectList[e.keyCode - 96]) {\n\t        $(selectList[e.keyCode - 96]).trigger('click');\n\t        setTimeout(reset, 100);\n\t      }\n\t      return;\n\t    }\n\t    if (e.keyCode > 47 && e.keyCode < 58 && !/^\\d+$/.test(word)) {\n\t      //0-9 是48-57 大键盘的数字键\n\t      if (selectList[e.keyCode - 48]) {\n\t        $(selectList[e.keyCode - 48]).trigger('click');\n\t        return setTimeout(reset, 100);\n\t      }\n\t      return;\n\t    }\n\t    if (e.keyCode == 9) {\n\t      $(selectList[0]).trigger('click');\n\t      return setTimeout(reset, 100);\n\t    }\n\t\n\t    if (e.keyCode == 40 || e.keyCode == 38) {\n\t      if (e.keyCode == 40) {\n\t        index++;\n\t        if (index >= selectList.length) {\n\t          index = 0;\n\t        }\n\t      }\n\t      if (e.keyCode == 38) {\n\t        index--;\n\t        if (index <= -selectList.length) {\n\t          index = 0;\n\t        }\n\t      }\n\t      selectList.css('background-color', '');\n\t      selectLi = selectList.eq(index);\n\t      selectLi.css('background-color', '#b2d8fa');\n\t    }\n\t  });\n\t\n\t  ele.on('input', function (e) {\n\t    //keypress要慢一拍 keypress input keyup\n\t    var word = getWord();\n\t    if (word) {\n\t\n\t      if (word == oldWord) {\n\t        return viewDrop.show();\n\t      }\n\t      oldWord = word;\n\t      var list = m_link.searchDirect(word);\n\t      if (list.length) {\n\t        index = -1;\n\t        selectLi = null;\n\t        viewDrop.reset(list);\n\t        selectList = viewDrop.find('li');\n\t      } else {\n\t        viewDrop.hide();\n\t      }\n\t    } else {\n\t      viewDrop.hide();\n\t    }\n\t  });\n\t});\n\tvar view = $('<div class=\"am-container\">' + '  <div class=\"am-margin-lg am-u-sm-11\" style=\"padding:0\" data-on=\"?m=fast_input\">' + '   <input id=\"content\" type=\"text\" class=\"am-form-field\" style=\"ime-mode:active\" autofocus=\"autofocus\" placeholder=\"地址直达（支持拼音首字母）\">' + '   <div class=\"autocomplete-dropdown\" data-selector=\"dropdown\" style=\"display:none\"></div>' + '   <input id=\"notify\" type=\"button\" class=\"\" style=\"\" value=\"通知一下\", title=\"在文本框中输入内容, 然后点击按钮可以通知作者.\" />' + '  </div>' + '</div>').setView({\n\t  name: 'link/input'\n\t});\n\t\n\tmodule.exports = view;\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports) {\n\n\t'use strict';\n\t\n\tfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\t\n\tvar createNGram = function createNGram(n) {\n\t  return function (str) {\n\t    var arr = [];\n\t    var end = str.length - n + 1;\n\t    for (var i = 0; i < end; i++) {\n\t      arr.push(str.substr(i, n));\n\t    }\n\t    return arr;\n\t  };\n\t};\n\t\n\tvar gramDict = {\n\t  4: createNGram(4),\n\t  3: createNGram(3),\n\t  2: createNGram(2)\n\t};\n\t\n\tvar getWordList = function getWordList() {\n\t  var str = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\t\n\t  var wordList = [str];\n\t  var processStrict = function processStrict(str) {\n\t    return str.replace(/['‘’][^'‘’]*['‘’]|[\"”“][^\"”“]*[\"”“]/g, function ($0) {\n\t      wordList.push($0.replace(/['‘’\"”“]/g, ''));\n\t      return ' ';\n\t    });\n\t  };\n\t\n\t  var processChiese = function processChiese(str) {\n\t    return str.replace(/[\\u4e00-\\u9fff\\uf900-\\ufaff]+/g, function ($0) {\n\t      wordList.push($0);\n\t      for (var i = 4; i > 1; i--) {\n\t        if ($0.length > i) {\n\t          wordList.push.apply(wordList, gramDict[i]($0));\n\t        }\n\t      }\n\t      return ' ';\n\t    });\n\t  };\n\t\n\t  var processEnglish = function processEnglish(str) {\n\t    wordList.push.apply(wordList, str.split(/[^a-zA-Z]/).filter(function (o) {\n\t      return o.length > 2;\n\t    }).map(function (o) {\n\t      return o.toLowerCase();\n\t    }));\n\t  };\n\t\n\t  processEnglish(processChiese(processStrict(str)));\n\t  //console.log('search RegExp', new RegExp(wordList.join('|'), 'ig'));\n\t  return wordList;\n\t};\n\t\n\tvar removeStopWord = function removeStopWord(str) {\n\t  str = str.replace(/\\s*```([^`\\n\\r]*)[^`]*```\\s*/g, function ($0, $1) {\n\t    return ' ' + $1 + ' ';\n\t  }); //去掉代码\n\t  str = str.replace(/<[^\\u4e00-\\u9fff\\uf900-\\ufaff>]+>|\\([^\\u4e00-\\u9fff\\uf900-\\ufaff)]+\\)|\\w+[:@][\\w.?#=&\\/]+/g, ' '); //去掉html标签及超链接\n\t  str = str.replace(/怎么|的|是|开始|很多|我|觉得|非常|可以|一|了|上面|下面|这|那|哪|个|this|return|with/g, ' '); //去停用词\n\t  str = str.replace(/[^\\u4e00-\\u9fff\\uf900-\\ufaff\\w]/g, ' '); //非中文或英文，替换成空格\n\t  return str;\n\t};\n\t\n\tvar getTFs = function getTFs() {\n\t  var str = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';\n\t\n\t  var wordList = getWordList(removeStopWord(str)).slice(1);\n\t  var threeDict = {};\n\t  var fourDict = {};\n\t  var tfDict = {};\n\t  var tfList = [];\n\t\n\t  wordList.forEach(function (o) {\n\t    if (o.length < 2) {\n\t      return;\n\t    }\n\t    if (tfDict[o]) {\n\t      tfDict[o]++;\n\t    } else {\n\t      if (o.length == 3) {\n\t        threeDict[o] = 1;\n\t      }\n\t      if (o.length == 4) {\n\t        fourDict[o] = 1;\n\t      }\n\t      tfDict[o] = 1;\n\t    }\n\t  });\n\t  var token;\n\t  //去掉非词\n\t\n\t  var _loop = function _loop() {\n\t    var frequency = tfDict[token];\n\t    gramDict[3](token).forEach(function (o) {\n\t      if (frequency === tfDict[o]) {\n\t        delete tfDict[o];\n\t        delete threeDict[o];\n\t        gramDict[2](o).forEach(function (item) {\n\t          if (frequency === tfDict[item]) {\n\t            delete tfDict[item];\n\t          }\n\t        });\n\t      }\n\t    });\n\t  };\n\t\n\t  for (token in fourDict) {\n\t    _loop();\n\t  }\n\t\n\t  var _loop2 = function _loop2() {\n\t    var frequency = tfDict[token];\n\t    gramDict[2](token).forEach(function (o) {\n\t      if (frequency === tfDict[o]) {\n\t        delete tfDict[o];\n\t      }\n\t    });\n\t  };\n\t\n\t  for (token in threeDict) {\n\t    _loop2();\n\t  }\n\t\n\t  for (token in tfDict) {\n\t    tfList.push({\n\t      token: token,\n\t      frequency: tfDict[token]\n\t    });\n\t  }\n\t  return tfList.sort(function (a, b) {\n\t    return b.frequency - a.frequency;\n\t  }); //.slice(0,10).map(o=>o.token);\n\t};\n\t\n\tmodule.exports = {\n\t  getWordList: getWordList,\n\t  getTFs: getTFs,\n\t  getGlobalRegex: function getGlobalRegex(str, flag) {\n\t    var wordSet = new Set(getWordList(str));\n\t    var wordList = [].concat(_toConsumableArray(wordSet));\n\t    return new RegExp(wordList.join('|'), flag || 'ig');\n\t  }\n\t};\n\n/***/ })\n]);\n\n\n// WEBPACK FOOTER //\n// tool.chunk_1.js","/**\r\n * @file 导航页面定义\r\n * @author ljquan@qq.com\r\n */\r\n\r\nvar o_navigator = require('card/common/navigator');\r\nvar c_link = require('card/tool/link');\r\nvar c_daohang = require('card/tool/daohang');\r\n\r\nmodule.exports = function(page) {\r\n  var viewNav = $('<div></div>').setView(o_navigator());\r\n      page.setView({\r\n          title: '导航',\r\n          viewList:[viewNav, c_link, c_daohang]\r\n      });\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/page/tool/link.js","const m_util = require('common/util');\r\nconst m_search = require('helper/search');\r\n\r\nlet links = [];\r\nlet linkTab = {};\r\nlet count = [];\r\n\r\nlet getLinks = new Promise((resolve) => {\r\n  BCD.ajaxCache('./json/link.json', function (data) {\r\n    if (data.length) {\r\n      m_util.load(['source/lib/pinyinjs/dict/pinyin_dict_firstletter.js',\r\n        'source/lib/pinyinjs/pinyinUtil.js'\r\n      ], () => {\r\n        links = [];\r\n        linkTab = [];\r\n        count = [];\r\n        data.forEach(o => {\r\n          let start = links.length;\r\n          // 如果count[o.groupid]不存在，则初始化为0\r\n          if (!count[o.groupid]) {\r\n            count[o.groupid] = 0;\r\n          }\r\n          (o.rows || []).forEach(str => {\r\n            // 对同一groupid进行计数\r\n            count[o.groupid] = count[o.groupid] + 1;\r\n            // console.info(\"count[o.groupid]=\", count[o.groupid]);\r\n            let arr = str.split(' | ');\r\n            let firstLetter = pinyinUtil.getFirstLetter(arr[0], true).join(' ');\r\n            if (arr.length) {\r\n              var favicon = '';\r\n              var url = arr[1];\r\n              if (url) {\r\n                var domain = url.split('/');\r\n                if (domain[2]) {\r\n                  // 使用本地的favicon\r\n                  favicon = 'https://fastly.jsdelivr.net/gh/anaer/anaer.github.io@master/favicon/' + domain[2] + '.ico';\r\n                }\r\n              }\r\n              let item = {\r\n                // 缩写\r\n                name: truncate(arr[0], 20),\r\n                title: arr[0],\r\n                href: arr[1],\r\n                favicon: favicon,\r\n                firstLetter: firstLetter,\r\n                searchKey: arr.concat(o.title, firstLetter).join(' ')\r\n              };\r\n              links.push(item);\r\n            }\r\n          });\r\n          if (o.groupid) {\r\n            let tab = {\r\n              title: o.title,\r\n              rows: links.slice(start),\r\n              // 如果未设置limit, 则默认为6, 同一组最多显示6条. 防止太长\r\n              limit: o.limit || 6\r\n            }\r\n            if (linkTab[o.groupid]) {\r\n              linkTab[o.groupid].push(tab);\r\n            } else {\r\n              linkTab[o.groupid] = [tab];\r\n            }\r\n          }\r\n        });\r\n        resolve(data);\r\n      });\r\n    } else {\r\n      resolve(data);\r\n    }\r\n    return data.length ? 1 : 0;\r\n  }, 0, 3E3, 1);\r\n}).catch((e) => console.info(e));\r\n\r\n/**\r\n * 截取字符串.\r\n *\r\n * @param {*} str 字符串\r\n * @param {*} limit 限制长度, 如果是中文, 再减4, 主要是中文宽度较宽\r\n * @returns\r\n */\r\nfunction truncate(str, limit) {\r\n  var chinese = RegExp('[\\u4e00-\\u9fa5]{0,}');\r\n  if (str.length > limit) {\r\n    if (chinese.test(str) && (limit - 4 > 0)) {\r\n      limit = limit - 4;\r\n    }\r\n    return str.slice(0, limit) + '...';\r\n  } else {\r\n    return str;\r\n  }\r\n}\r\n\r\n//搜索直达\r\nconst searchDirect = (word) => {\r\n  let reg = m_search.getGlobalRegex(word, 'i');\r\n  let regGlobal = m_search.getGlobalRegex(word, 'ig');\r\n  //console.log(reg);\r\n  return links.filter(o => reg.test(o.searchKey)).map(o => {\r\n    let weight = 0;\r\n    let item = {\r\n      href: o.href,\r\n      name: o.name.replace(regGlobal, function ($0) {\r\n        weight += 3 * $0.length;\r\n        return '<span class=\"am-text-danger\">' + $0 + '</span>';\r\n      })\r\n    };\r\n    if (word.length > 1) {\r\n      item.searchHref = o.href.replace(regGlobal, function ($0) {\r\n        weight += $0.length;\r\n        return '<span class=\"am-text-danger\">' + $0 + '</span>';\r\n      });\r\n    } else {\r\n      item.searchHref = o.href;\r\n    }\r\n\r\n    o.firstLetter.replace(regGlobal, function ($0) {\r\n      weight += 2 * $0.length;\r\n      return $0;\r\n    });\r\n    item.weight = weight\r\n    return item;\r\n  }).sort((a, b) => b.weight - a.weight).slice(0, 10);\r\n};\r\nmodule.exports = {\r\n  getLinks,\r\n  searchDirect,\r\n  getLinksSync: () => links,\r\n  getLinkTabSync: () => linkTab\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/model/link.js","var o_linktab = require('card/common/linktab');\r\n\r\n\r\nmodule.exports = function(container, linkTab){\r\n    let count = 0;\r\n    let styles = ['', 'warning', 'danger', 'success'];\r\n    for(var key in linkTab){\r\n      let style = styles[count % 4];\r\n      count++;\r\n      let subContainer = $('<div></div>').setView(o_linktab({\r\n          full: 'append'\r\n      }));\r\n      linkTab[key].forEach(d=> {\r\n        d.style = style;\r\n        subContainer.reset(d);\r\n      });\r\n      container.append(subContainer);\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/common/daohang.js","BCD.addEvent('expand', function(ele){\r\n    ele.on('click', function(e){\r\n        ele.find('ul.am-list > li.expand').toggleClass('am-hide');\r\n    });\r\n\r\n})\r\n\r\n// 默认隐藏二维码button\r\nmodule.exports = function(option) {\r\n    return $.extend({\r\n        name: 'common/linktab',\r\n        template: '<div class=\"am-u-sm-12 am-u-md-6 am-u-lg-4\">' +\r\n            '    <section class=\"am-panel am-panel-<%=obj.style||\"secondary\"%>\"  data-on=\"?m=expand\">' +\r\n            '        <header class=\"am-panel-hd\" >' +\r\n            '            <h3 class=\"am-panel-title\" ><%=obj.title%></h3>' +\r\n            '        </header>' +\r\n            '        <div class=\"am-panel-bd\">' +\r\n            '            <ul class=\"am-list\">' +\r\n            '                <%var list = obj.rows; for(var i=0, len=list.length; i<len; i++){%>' +\r\n            '                <%if(i < obj.limit){ %>'+\r\n            '                <li style=\"padding:8px\">'+\r\n            '                  <span >'+\r\n            '                    <a data-on=\"?m=<%=config.isEnv ? \"goEnv\" : \"go\"%>&target=_blank\" data-url=\"<%=list[i].href%>\" title=\"<%=list[i].title%>\">'+\r\n            '                      <img style=\"height:16px; width:16px\" src=\"<%=list[i].favicon%>\">  </img><%=list[i].name%>'+\r\n            '                    </a>'+\r\n            '                  </span>' +\r\n            '                <button style=\"display:none\" type=\"button\" class=\"am-btn am-btn-default am-btn-xs\" style=\"float:right\" data-on=\"?m=goQR<%=config.isEnv ? \"&env=1\" : \"\"%>\" data-url=\"<%=list[i].href%>\">QR</button>'+\r\n            '                </li>'+\r\n            '                <%} else {%>'+\r\n            '                <li style=\"padding:8px\" class=\"expand am-hide\" >'+\r\n            '                  <span >'+\r\n            '                    <a data-on=\"?m=<%=config.isEnv ? \"goEnv\" : \"go\"%>&target=_blank\" data-url=\"<%=list[i].href%>\" title=\"<%=list[i].title%>\">'+\r\n            '                      <img style=\"height:16px; width:16px\" src=\"<%=list[i].favicon%>\">  </img><%=list[i].name%>'+\r\n            '                    </a>'+\r\n            '                  </span>' +\r\n            '                <button style=\"display:none\" type=\"button\" class=\"am-btn am-btn-default am-btn-xs\" style=\"float:right\" data-on=\"?m=goQR<%=config.isEnv ? \"&env=1\" : \"\"%>\" data-url=\"<%=list[i].href%>\">QR</button>'+\r\n            '                </li>'+\r\n            '                <%}%>' +\r\n            '                <%}%>' +\r\n            '            </ul>' +\r\n            '        </div>' +\r\n            '    </section>' +\r\n            '</div>'\r\n    }, option);\r\n};\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/common/linktab.js","\r\nvar m_link = require('model/link');\r\n\r\nvar c_daohang = require('card/common/daohang');\r\n\r\nvar container = $('<div class=\"am-container\"></div>');\r\n\r\n\r\nm_link.getLinks.then(function(data){\r\n    c_daohang(container, m_link.getLinkTabSync());\r\n});\r\n\r\nmodule.exports = container;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/tool/daohang.js"," //地址\r\nvar m_link = require('model/link');\r\n\r\nBCD.addEvent('fast_input', function(ele) {\r\n  let viewInput = ele.find('#content');\r\n  let viewDrop = ele.find('[data-selector=\"dropdown\"]');\r\n  let btnNotify = ele.find('#notify');\r\n  viewDrop.setView({\r\n    name: 'link/drop',\r\n    template: '<ul><%(obj ||[]).forEach(function(o, i){%>' +\r\n      '<li data-on=\"?m=open\" data-url=\"<%=o.href%>\">'+\r\n      ' <div class=\"left\"><span class=\"am-badge am-round\"><%=i%></span></div>'+\r\n      ' <div class=\"right\"><a><%=o.name%></a><div class=\"addr\"><%=o.searchHref%></div></div>'+\r\n      '</li>' +\r\n      '<%})%></ul>'+\r\n      '<div class=\"tips\">提示：Tab键打开第一个链接、数字键打开对应链接、上下键选择、回车键打开、Esc键还原</div>',\r\n    end: function(data) {\r\n      if (!data.length) {\r\n        return 'hide';\r\n      }\r\n    }\r\n  });\r\n  let selectLi = null;\r\n  let selectList = null;\r\n  let index = -1;\r\n  let oldWord = '';\r\n  const reset = () => {\r\n    viewDrop.hide();\r\n    viewInput.val('');\r\n    selectLi = null;\r\n    selectList = null;\r\n    index = -1;\r\n    oldWord = '';\r\n    setTimeout(()=>viewInput[0].focus(), 300);\r\n  };\r\n  const doSearch = () => {\r\n    let href = 'https://www.baidu.com/s?wd='+encodeURIComponent(getWord());\r\n    // let href = 'https://www.ecosia.org/search?q='+encodeURIComponent(getWord());\r\n    // let href = 'https://duckduckgo.com/?q='+encodeURIComponent(getWord());\r\n    reset();\r\n    window.open(href);\r\n  };\r\n  const getWord = () => viewInput.val().trim();\r\n  viewInput.on('blur', function(){\r\n    setTimeout(function(){\r\n      viewDrop.hide();\r\n    }, 300);\r\n  });\r\n\r\n  btnNotify.on('click', function(){\r\n    setTimeout(function(){\r\n      let word = getWord();\r\n      if (word) {\r\n        $.ajax({\r\n            url: \"https://api2.pushdeer.com/message/push?pushkey=PDU3423TORUEz2NZHKZVIpSlb2ErGJcERTunXneI&text=\"+encodeURIComponent(word),\r\n            type: 'get',\r\n            dataType: 'jsonp',  // 请求方式为jsonp\r\n            crossDomain: true,\r\n            data: {},\r\n            success: function(data) {},\r\n        });\r\n        // 放success里 好像没提示, 不搞前端, 不确定原因, 先放外面提示已通知\r\n        // alert('已通知');\r\n        $(btnNotify).tip('已通知');\r\n      }\r\n    }, 300);\r\n  })\r\n  ele.on('keydown', function(e) { //上下选择\r\n    //console.log(e.keyCode);\r\n    if(e.keyCode==27){\r\n      return reset();\r\n    }\r\n    if (e.keyCode == 13) {\r\n      if (selectLi) {\r\n        selectLi.trigger('click');\r\n        reset();\r\n      } else {\r\n        doSearch();\r\n      }\r\n      return;\r\n    }\r\n    if(!(selectList && selectList.length)){\r\n      return;\r\n    }\r\n    let word = getWord();\r\n    if(e.keyCode>95 && e.keyCode < 106 &&(!/^\\d+$/.test(word))){ //0-9 是96-105 小键盘的数字键\r\n      if(selectList[e.keyCode-96]){\r\n        $(selectList[e.keyCode-96]).trigger('click');\r\n        setTimeout(reset, 100);\r\n      }\r\n      return;\r\n    }\r\n    if(e.keyCode>47 && e.keyCode < 58 &&(!/^\\d+$/.test(word))){ //0-9 是48-57 大键盘的数字键\r\n      if(selectList[e.keyCode-48]){\r\n        $(selectList[e.keyCode-48]).trigger('click');\r\n        return setTimeout(reset, 100);\r\n      }\r\n      return;\r\n    }\r\n    if(e.keyCode==9){\r\n      $(selectList[0]).trigger('click');\r\n      return setTimeout(reset, 100);\r\n    }\r\n\r\n    if (e.keyCode == 40 || e.keyCode == 38) {\r\n      if (e.keyCode == 40) {\r\n        index++;\r\n        if (index >= selectList.length) {\r\n          index = 0;\r\n        }\r\n      }\r\n      if (e.keyCode == 38) {\r\n        index--;\r\n        if (index <= -selectList.length) {\r\n          index = 0;\r\n        }\r\n      }\r\n      selectList.css('background-color', '');\r\n      selectLi = selectList.eq(index);\r\n      selectLi.css('background-color', '#b2d8fa');\r\n    }\r\n  });\r\n\r\n  ele.on('input', function(e) { //keypress要慢一拍 keypress input keyup\r\n    let word = getWord();\r\n    if (word) {\r\n\r\n      if (word == oldWord) {\r\n        return viewDrop.show();\r\n      }\r\n      oldWord = word;\r\n      let list = m_link.searchDirect(word);\r\n      if (list.length) {\r\n        index = -1;\r\n        selectLi = null;\r\n        viewDrop.reset(list);\r\n        selectList = viewDrop.find('li');\r\n      }else{\r\n        viewDrop.hide();\r\n      }\r\n    } else {\r\n      viewDrop.hide();\r\n    }\r\n  });\r\n\r\n});\r\nvar view = $(\r\n  '<div class=\"am-container\">' +\r\n  '  <div class=\"am-margin-lg am-u-sm-11\" style=\"padding:0\" data-on=\"?m=fast_input\">' +\r\n  '   <input id=\"content\" type=\"text\" class=\"am-form-field\" style=\"ime-mode:active\" autofocus=\"autofocus\" placeholder=\"地址直达（支持拼音首字母）\">' +\r\n  '   <div class=\"autocomplete-dropdown\" data-selector=\"dropdown\" style=\"display:none\"></div>' +\r\n  '   <input id=\"notify\" type=\"button\" class=\"\" style=\"\" value=\"通知一下\", title=\"在文本框中输入内容, 然后点击按钮可以通知作者.\" />' +\r\n  '  </div>'+\r\n  '</div>').setView({\r\n  name: 'link/input'\r\n});\r\n\r\nmodule.exports = view;\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/card/tool/link.js","const createNGram = (n) => (str) => {\r\n  let arr = [];\r\n  let end = str.length - n + 1;\r\n  for (var i = 0; i < end; i++) {\r\n    arr.push(str.substr(i, n));\r\n  }\r\n  return arr;\r\n}\r\n\r\nconst gramDict = {\r\n  4: createNGram(4),\r\n  3: createNGram(3),\r\n  2: createNGram(2)\r\n};\r\n\r\nconst getWordList = (str = '') => {\r\n  let wordList = [str];\r\n  let processStrict = (str) => str.replace(/['‘’][^'‘’]*['‘’]|[\"”“][^\"”“]*[\"”“]/g, function($0) {\r\n    wordList.push($0.replace(/['‘’\"”“]/g, ''));\r\n    return ' ';\r\n  });\r\n\r\n\r\n  let processChiese = (str) => str.replace(/[\\u4e00-\\u9fff\\uf900-\\ufaff]+/g, function($0) {\r\n    wordList.push($0);\r\n    for (var i = 4; i > 1; i--) {\r\n      if ($0.length > i) {\r\n        wordList.push.apply(wordList, gramDict[i]($0));\r\n      }\r\n    }\r\n    return ' ';\r\n  });\r\n\r\n  let processEnglish = (str) => {\r\n    wordList.push.apply(wordList,\r\n      str.split(/[^a-zA-Z]/)\r\n      .filter(o => o.length > 2)\r\n      .map(o => o.toLowerCase()));\r\n  };\r\n\r\n  processEnglish(processChiese(processStrict(str)));\r\n  //console.log('search RegExp', new RegExp(wordList.join('|'), 'ig'));\r\n  return wordList;\r\n};\r\n\r\nconst removeStopWord = (str) => {\r\n  str = str.replace(/\\s*```([^`\\n\\r]*)[^`]*```\\s*/g, function($0, $1){return ' '+$1+' ';}); //去掉代码\r\n  str = str.replace(/<[^\\u4e00-\\u9fff\\uf900-\\ufaff>]+>|\\([^\\u4e00-\\u9fff\\uf900-\\ufaff)]+\\)|\\w+[:@][\\w.?#=&\\/]+/g, ' ');//去掉html标签及超链接\r\n  str = str.replace(/怎么|的|是|开始|很多|我|觉得|非常|可以|一|了|上面|下面|这|那|哪|个|this|return|with/g, ' '); //去停用词\r\n  str = str.replace(/[^\\u4e00-\\u9fff\\uf900-\\ufaff\\w]/g, ' '); //非中文或英文，替换成空格\r\n  return str;\r\n}\r\n\r\nconst getTFs = (str = '') => {\r\n  let wordList = getWordList(removeStopWord(str)).slice(1);\r\n  let threeDict = {};\r\n  let fourDict = {};\r\n  let tfDict = {};\r\n  let tfList = [];\r\n\r\n  wordList.forEach(o => {\r\n    if (o.length < 2) {\r\n      return;\r\n    }\r\n    if (tfDict[o]) {\r\n      tfDict[o]++;\r\n    } else {\r\n      if (o.length == 3) {\r\n        threeDict[o] = 1;\r\n      }\r\n      if (o.length == 4) {\r\n        fourDict[o] = 1;\r\n      }\r\n      tfDict[o] = 1;\r\n    }\r\n  });\r\n  var token;\r\n  //去掉非词\r\n  for (token in fourDict) {\r\n    let frequency = tfDict[token];\r\n    gramDict[3](token).forEach(o => {\r\n      if (frequency === tfDict[o]) {\r\n        delete tfDict[o];\r\n        delete threeDict[o];\r\n        gramDict[2](o).forEach(item => {\r\n          if (frequency === tfDict[item]) {\r\n            delete tfDict[item];\r\n          }\r\n        });\r\n      }\r\n    });\r\n  }\r\n  for (token in threeDict) {\r\n    let frequency = tfDict[token];\r\n    gramDict[2](token).forEach(o => {\r\n      if (frequency === tfDict[o]) {\r\n        delete tfDict[o];\r\n      }\r\n    });\r\n  }\r\n\r\n  for (token in tfDict) {\r\n    tfList.push({\r\n      token,\r\n      frequency: tfDict[token]\r\n    });\r\n  }\r\n  return tfList.sort((a, b) => b.frequency - a.frequency);//.slice(0,10).map(o=>o.token);\r\n}\r\n\r\nmodule.exports = {\r\n  getWordList,\r\n  getTFs,\r\n  getGlobalRegex: (str, flag) => {\r\n    let wordSet = new Set(getWordList(str));\r\n    let wordList = [...wordSet];\r\n    return new RegExp(wordList.join('|'), flag||'ig');\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./source/src/helper/search.js"],"sourceRoot":""}